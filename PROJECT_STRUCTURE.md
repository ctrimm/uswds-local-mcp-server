# Project Structure

This document explains what this project is, how it's organized, and what each file does.

---

## üì¶ What Is This Project?

This is a **single, simple Node.js MCP (Model Context Protocol) server** that provides USWDS (U.S. Web Design System) component information and tools to Claude Desktop or other MCP clients.

### What It Does:
- ‚úÖ Provides 25 tools for working with USWDS components
- ‚úÖ Switches between vanilla USWDS and React-USWDS modes
- ‚úÖ Generates code, validates accessibility, checks color contrast
- ‚úÖ Browses design tokens, icons, and layout patterns

### What It Doesn't Do:
- ‚ùå No Python, CUDA, or GPU requirements
- ‚ùå No OLLAMA or fine-tuning
- ‚ùå No browser automation
- ‚ùå No separate servers (it's one server with 25 tools)
- ‚ùå No databases or external dependencies

---

## üóÇÔ∏è Directory Structure

```
uswds-local-mcp-server/
‚îÇ
‚îú‚îÄ‚îÄ src/                          # TypeScript source code
‚îÇ   ‚îú‚îÄ‚îÄ index.ts                  # Main entry point (defines all 25 tools)
‚îÇ   ‚îú‚îÄ‚îÄ services/                 # Business logic services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ code-generator-service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ color-contrast-service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ comparison-service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ component-service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ design-token-service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ icon-service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout-service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ suggestion-service.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tailwind-uswds-service.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validation-service.ts
‚îÇ   ‚îú‚îÄ‚îÄ data/                     # Static component/token data
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ layout-patterns.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ page-templates.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ react-components.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ uswds-icons.ts
‚îÇ   ‚îî‚îÄ‚îÄ __tests__/                # Unit tests for services
‚îÇ       ‚îî‚îÄ‚îÄ *-service.test.ts
‚îÇ
‚îú‚îÄ‚îÄ dist/                         # Compiled JavaScript (generated by npm run build)
‚îÇ   ‚îî‚îÄ‚îÄ index.js                  # Compiled entry point
‚îÇ
‚îú‚îÄ‚îÄ docs/                         # Additional documentation
‚îÇ   ‚îî‚îÄ‚îÄ future-vision/            # Future/aspirational docs
‚îÇ       ‚îú‚îÄ‚îÄ FUTURE_AGENT_VISION.md
‚îÇ       ‚îî‚îÄ‚îÄ FUTURE_ARCHITECTURE.md
‚îÇ
‚îú‚îÄ‚îÄ examples/                     # Example usage and configurations
‚îÇ
‚îú‚îÄ‚îÄ .nvmrc                        # Node version specification (20)
‚îú‚îÄ‚îÄ package.json                  # Project dependencies and scripts
‚îú‚îÄ‚îÄ tsconfig.json                 # TypeScript configuration
‚îú‚îÄ‚îÄ jest.config.js                # Test configuration
‚îú‚îÄ‚îÄ start-mcp-server.sh           # Wrapper script for nvm compatibility
‚îú‚îÄ‚îÄ .env.example                  # Environment variable template
‚îÇ
‚îî‚îÄ‚îÄ Documentation Files:
    ‚îú‚îÄ‚îÄ README.md                 # Main project documentation
    ‚îú‚îÄ‚îÄ QUICK_START.md            # 5-minute setup guide
    ‚îú‚îÄ‚îÄ SETUP.md                  # Detailed installation guide
    ‚îú‚îÄ‚îÄ CLAUDE_DESKTOP_CONFIG.md  # Claude Desktop configuration
    ‚îú‚îÄ‚îÄ NVM_SETUP.md              # Node version management
    ‚îú‚îÄ‚îÄ TROUBLESHOOTING.md        # Common issues and fixes
    ‚îú‚îÄ‚îÄ CONTRIBUTING.md           # Contribution guidelines
    ‚îú‚îÄ‚îÄ NPM_PUBLISHING_GUIDE.md   # How to publish to NPM
    ‚îú‚îÄ‚îÄ DOCKER_SETUP.md           # Optional Docker setup
    ‚îú‚îÄ‚îÄ FUTURE_TOOLS.md           # Roadmap of planned features
    ‚îú‚îÄ‚îÄ CHANGELOG.md              # Version history
    ‚îî‚îÄ‚îÄ PROJECT_STRUCTURE.md      # This file
```

---

## üîß Core Files Explained

### `src/index.ts` - The Heart of the Server

This is the **only entry point**. It:
1. Imports all service classes
2. Defines all 25 MCP tools with their schemas
3. Handles tool invocations
4. Starts the MCP server

**Environment Variables:**
- `USE_REACT_COMPONENTS` - Toggle between vanilla USWDS and React-USWDS

### Service Files (`src/services/`)

Each service handles a specific domain:

| Service | Purpose |
|---------|---------|
| `component-service.ts` | Component info, docs search, accessibility guidance |
| `design-token-service.ts` | USWDS design tokens (colors, spacing, typography) |
| `validation-service.ts` | Code validation for USWDS patterns and accessibility |
| `color-contrast-service.ts` | WCAG color contrast checking |
| `icon-service.ts` | Browse and search 90+ USWDS icons |
| `layout-service.ts` | Common layout patterns using USWDS Grid |
| `suggestion-service.ts` | AI-powered component recommendations |
| `comparison-service.ts` | Compare components side-by-side |
| `code-generator-service.ts` | Generate components, forms, tables, modals, projects |
| `tailwind-uswds-service.ts` | Tailwind + USWDS integration docs |

### Data Files (`src/data/`)

Static data about USWDS components:

| File | Contents |
|------|----------|
| `react-components.ts` | 46 React-USWDS components with props and examples |
| `page-templates.ts` | 7 full-page React templates |
| `uswds-icons.ts` | 90+ USWDS icons with metadata |
| `layout-patterns.ts` | Common layout recipes |

### Configuration Files

| File | Purpose |
|------|---------|
| `package.json` | Dependencies, scripts, NPM metadata |
| `tsconfig.json` | TypeScript compiler settings |
| `jest.config.js` | Testing configuration |
| `.nvmrc` | Specifies Node 20 requirement |
| `.env.example` | Template for environment variables |

### Scripts

| File | Purpose |
|------|---------|
| `start-mcp-server.sh` | Wrapper script that loads correct Node version via nvm |

---

## üõ†Ô∏è How It Works

### 1. User Configures Claude Desktop

```json
{
  "mcpServers": {
    "uswds": {
      "command": "/path/to/start-mcp-server.sh",
      "env": {
        "USE_REACT_COMPONENTS": "false"
      }
    }
  }
}
```

### 2. Claude Desktop Starts the Server

```bash
./start-mcp-server.sh
  ‚îî‚îÄ> Loads Node 20 via nvm
  ‚îî‚îÄ> Runs: node dist/index.js
```

### 3. Server Initializes

```typescript
// src/index.ts
const server = new Server({
  name: 'uswds-mcp-server',
  version: '0.1.0'
});

// Register 25 tools
server.setRequestHandler(ListToolsRequestSchema, ...);
server.setRequestHandler(CallToolRequestSchema, ...);
```

### 4. Claude Uses Tools

When Claude needs USWDS information:
```
Claude ‚Üí Calls "list_components"
     ‚Üí Server executes componentService.listComponents()
     ‚Üí Returns component data
     ‚Üí Claude uses data to help user
```

---

## üìä Data Flow

```
User asks Claude about USWDS
        ‚Üì
Claude Desktop calls MCP tool
        ‚Üì
start-mcp-server.sh ensures Node 20
        ‚Üì
dist/index.js receives tool call
        ‚Üì
Routes to appropriate service
        ‚Üì
Service fetches/generates data
        ‚Üì
Returns JSON response
        ‚Üì
Claude presents to user
```

---

## üîç Available Tools (25 Total)

### Component & Template Tools
1. `list_components` - Browse components by category
2. `get_component_info` - Get detailed component docs
3. `list_page_templates` - Browse React templates (React mode only)
4. `get_page_template` - Get full template code (React mode only)

### AI-Powered Tools
5. `suggest_components` - Get component recommendations
6. `compare_components` - Compare two components
7. `generate_component_code` - Generate component code
8. `generate_form` - Scaffold complete forms
9. `generate_multi_step_form` - Create wizard forms
10. `generate_data_table` - Generate tables with sorting/filtering
11. `generate_modal_dialog` - Create accessible modals
12. `scaffold_project` - Generate complete project structure
13. `convert_html_to_react` - Convert USWDS HTML to React

### Design & Layout Tools
14. `get_design_tokens` - Access color, spacing, typography tokens
15. `check_color_contrast` - Validate WCAG contrast ratios
16. `get_icons` - Browse and search USWDS icons
17. `get_layout_patterns` - Get common layout recipes

### Validation & Docs
18. `validate_uswds_code` - Check code compliance and accessibility
19. `search_docs` - Search USWDS documentation
20. `get_accessibility_guidance` - Get WCAG compliance guidance

### Tailwind + USWDS Integration (5 tools)
21. `get_tailwind_uswds_getting_started` - Setup guide
22. `get_tailwind_uswds_component` - Component docs
23. `get_tailwind_uswds_javascript` - JS integration
24. `get_tailwind_uswds_colors` - Color utilities
25. `get_tailwind_uswds_icons` - Icon docs
26. `search_tailwind_uswds_docs` - Search Tailwind USWDS docs

---

## üß™ Testing

```bash
# Run all tests
npm test

# Watch mode
npm run test:watch

# Coverage report
npm run test:coverage
```

Tests are located in `src/__tests__/` and cover all service classes.

**Current Coverage:** ~68%

---

## üèóÔ∏è Build Process

```bash
# Install dependencies
npm install

# Build TypeScript ‚Üí JavaScript
npm run build

# Output: dist/index.js
```

The build process:
1. TypeScript compiler (`tsc`) reads `tsconfig.json`
2. Compiles `src/**/*.ts` to JavaScript
3. Outputs to `dist/` directory
4. Preserves directory structure

---

## üì¶ Dependencies

### Production Dependencies
- `@modelcontextprotocol/sdk` - MCP protocol implementation
- `axios` - HTTP client for fetching docs
- `cheerio` - HTML parsing for conversion tool
- `node-fetch` - Fetch API for Node.js

### Development Dependencies
- `typescript` - TypeScript compiler
- `@types/node` - Node.js type definitions
- `jest` - Testing framework
- `ts-jest` - TypeScript support for Jest

**Total Size:** ~50MB installed (mostly type definitions)

---

## üöÄ Development Workflow

### 1. Make Changes
```bash
# Edit TypeScript files in src/
vim src/services/my-service.ts
```

### 2. Build
```bash
npm run build
```

### 3. Test Locally
```bash
# Direct test
node dist/index.js

# MCP Inspector (web UI)
npm run inspector
```

### 4. Test in Claude Desktop
- Restart Claude Desktop
- Test your changes

### 5. Run Tests
```bash
npm test
```

---

## üìù Documentation Files

### For Users (Getting Started):
- **README.md** - Start here! Project overview and features
- **QUICK_START.md** - 5-minute installation guide
- **SETUP.md** - Detailed setup instructions

### For Configuration:
- **CLAUDE_DESKTOP_CONFIG.md** - Claude Desktop setup
- **NVM_SETUP.md** - Node version management
- **.env.example** - Environment variable reference

### For Troubleshooting:
- **TROUBLESHOOTING.md** - Common issues and fixes

### For Contributors:
- **CONTRIBUTING.md** - How to contribute
- **FUTURE_TOOLS.md** - Planned features roadmap
- **CHANGELOG.md** - Version history

### For Publishing:
- **NPM_PUBLISHING_GUIDE.md** - How to publish to NPM

### Optional:
- **DOCKER_SETUP.md** - Docker setup (alternative to Node.js)

### Aspirational (Not Current):
- **docs/future-vision/** - Future plans and architectures

---

## üéØ Key Concepts

### MCP (Model Context Protocol)
- Protocol for LLMs to access external tools
- Server exposes tools, clients (like Claude) use them
- JSON-based request/response

### Tool Definition
Each tool has:
- **Name** - Unique identifier
- **Description** - What it does
- **Input Schema** - Required/optional parameters
- **Handler** - Function that executes the tool

Example:
```typescript
{
  name: 'list_components',
  description: 'List all USWDS components',
  inputSchema: {
    type: 'object',
    properties: {
      category: { type: 'string' }
    }
  }
}
```

### Service Pattern
Business logic is separated into service classes:
- Single responsibility
- Easily testable
- Reusable across tools

---

## üîÑ Modes

### Vanilla USWDS Mode
```bash
USE_REACT_COMPONENTS=false
```
- Provides HTML/CSS examples
- USWDS 3.x documentation
- No React dependencies

### React-USWDS Mode
```bash
USE_REACT_COMPONENTS=true
```
- Provides React components
- TypeScript examples
- @trussworks/react-uswds components
- Includes page templates

---

## üìà Future Plans

See [FUTURE_TOOLS.md](FUTURE_TOOLS.md) for planned features, including:
- Enhanced accessibility testing
- Migration tools
- Testing helpers
- Performance analysis

---

## ‚ùì FAQ

### Q: Do I need Python?
**A:** No. This is pure Node.js/TypeScript.

### Q: Do I need OLLAMA?
**A:** No. The server provides data to Claude; it doesn't run its own AI.

### Q: Do I need a GPU?
**A:** No. This is a simple data server, not a training system.

### Q: Do I need multiple servers?
**A:** No. It's one server with 25 built-in tools.

### Q: How much does it cost?
**A:** Free and open source (AGPL-3.0 license). Just need Claude Desktop.

### Q: Can I use it without Claude?
**A:** Yes! Any MCP client can use it. Test with `npm run inspector`.

---

## üìö Learn More

- [USWDS Official Site](https://designsystem.digital.gov/)
- [React-USWDS](https://github.com/trussworks/react-uswds)
- [MCP Protocol](https://modelcontextprotocol.io/)
- [TypeScript Docs](https://www.typescriptlang.org/)

---

**Questions?** See [TROUBLESHOOTING.md](TROUBLESHOOTING.md) or [open an issue](https://github.com/ctrimm/uswds-local-mcp-server/issues).
